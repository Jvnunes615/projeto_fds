{% extends 'base/global/base.html' %}
{% block content %}
{% load static %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">

<style>
    /* Seu código CSS já existente */
    /* (não alterado para manter a estrutura) */
</style>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<h1 style="display: flex; align-items: center;">
    {{ detalhes_produto.nome_produto }}
</h1>

<div class="flex-container2">
    <div class="left-content2">
        <h2>{{detalhes_produto.endereco}}</h2>
    </div>
    <div class="right-content2">
        <div class="btn-group">
            {% if user.is_authenticated %}
            {% if produto %}
            {% if favorito %}
            <button class="btn">

                <a href="{% url 'mercado:favoritar' produto.id %}"
                    style="display: flex; align-items: center; text-decoration: none; color: darkred;">
                    <i class="fa fa-heart fav-icon {% if produto.id in favoritos %}favorited{% endif %}"
                    data-url="{% url 'mercado:favoritar' produto.id %}"></i>
                </a>
            </button>
            {% else %}
            <button class="btn">
                <a href="{% url 'mercado:favoritar' produto.id %}"
                    style="display: flex; align-items: center; text-decoration: none; color: black;">
                    <i class="fa fa-heart fav-icon {% if produto.id in favoritos %}favorited{% endif %}"
                    data-url="{% url 'mercado:favoritar' produto.id %}"></i>
                </a>
            </button>
            {% endif %}
            {% endif %}
            {% else %}
            <button class="btn">
                <a href="{% url 'mercado:login' %}"
                    style="display: flex; align-items: center; text-decoration: none; color: black;">
                    <i class="fa fa-heart fav-icon {% if produto.id in favoritos %}favorited{% endif %}"
                    data-url="{% url 'mercado:favoritar' produto.id %}"></i>
                </a>
            </button>
            {% endif %}
        </div>
    </div>
</div>

</div>

<div class="cards">
    <div class="card">
        <div class="carousel-inner">
            {% if produto.foto_ambiente %}
            <div class="carousel-item active">
                <img src="{{ produto.foto_ambiente.url }}" class="d-block w-100 img-bordered" alt="{{ produto.nome_produto }}">
            </div>
            {% else %}
            <div class="carousel-item active">
                <svg class="bd-placeholder-img d-block w-100 img-bordered" width="500" height="400"
                    xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Thumbnail"
                    preserveAspectRatio="xMidYMid slice" focusable="false">
                    <title>Placeholder</title>
                    <rect width="500" height="400" fill="#55595c" rx="40" ry="40"></rect>
                    <text x="35%" y="50%" fill="#eceeef" dy=".3em">{{ produto.nome_produto }}</text>
                </svg>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Novo botão Adicionar ao Carrinho -->
<div class="button-container">
    <form action="{% url 'mercado:adicionar_ao_carrinho' produto.id %}" method="POST">
        {% csrf_token %}
        <button type="submit" class="rounded-button">Adicionar ao Carrinho</button>
    </form>
</div>

<div class="flex-container">
    <div class="left-content">
        <div class="card3">
            <div class="collums">
                <p class="text_descricao">Sobre o produto</p>
                <p class="detalhes_descricao">{{ produto.descricao }}</p>
            </div>
        </div>
    </div>
    <div class="right-content">
        <div class="card4">
            <table>
                <thead>
                    <tr>
                        <th>
                            <p>Especificações<br>
                                Estoque : {{produto.estoque}}<br>
                                Preço : {{produto.preco}}
                            </p>
                        </th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
</div>

<h2 class="ver_mais">Veja mais produtos</h2>
<div class="sugestoes-produto">
    {% for sugerida in outros_produto %}
    <div class="sugestao-card">
        {% if sugerida.foto_ambiente %}
        <img src="{{ sugerida.foto_ambiente.url }}" alt="{{ sugerida.nome }}" class="sugestao-img">
        {% endif %}
        <div class="sugestao-info">
            <h3>{{ sugerida.nome_produto }}</h3>
            <p><a href="{% url 'mercado:detalhes' sugerida.id %}">Mais detalhes</a></p>
        </div>
    </div>
    {% endfor %}
</div>

<div id="myModal" class="modal">
    <span class="close">&times;</span>
    <img class="modal-content" id="img01">
    <div id="caption"></div>
</div>

<script>
    var modal = document.getElementById("myModal");

    var modalImg = document.getElementById("img01");
    var images = document.querySelectorAll('.review-images img');
    images.forEach(img => {
        img.onclick = function () {
            modal.style.display = "block";
            modalImg.src = this.src;
        }
    });

    var span = document.getElementsByClassName("close")[0];

    span.onclick = function () {
        modal.style.display = "none";
    }
</script>

{% endblock %}
